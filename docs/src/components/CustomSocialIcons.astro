---
const githubRepo = "WilliamKarolDiCioccio/saturn";
---

<a
  href={`https://github.com/${githubRepo}`}
  class="github-link"
  target="_blank"
  rel="noopener noreferrer"
>
  <p class="star-label">Star on GitHub</p>

  <span class="star-count" data-repo={githubRepo}>
    <svg class="star-icon" viewBox="0 0 24 24" fill="currentColor">
      <path
        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
      ></path>
    </svg>
    <span class="count">⋯</span>
  </span>
</a>

<style>
  .github-link {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .github-link:hover {
    color: rgba(255, 255, 255, 0.95);
  }

  .github-icon {
    width: 1.5rem;
    height: 1.5rem;
    transition: transform 0.3s ease;
  }

  .star-label:hover {
    text-decoration: underline;
  }

  .github-link:hover .github-icon {
    transform: scale(1.1);
  }

  .star-count {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.9375rem;
    font-weight: 500;
    font-variant-numeric: tabular-nums;
  }

  .star-icon {
    width: 1rem;
    height: 1rem;
    color: #fbbf24;
    filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.4));
    animation: starGlow 2s ease-in-out infinite;
  }

  .github-link .star-icon {
    animation:
      starGlow 0.8s ease-in-out infinite,
      starPulse 0.3s ease-out;
  }

  @keyframes starGlow {
    0%,
    100% {
      filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.4));
    }
    50% {
      filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.6));
    }
  }

  @keyframes starPulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.2);
    }
    100% {
      transform: scale(1);
    }
  }

  .count {
    color: rgba(255, 255, 255, 0.8);
  }
</style>

<script>
  async function fetchStarCount(repo: string): Promise<number | null> {
    try {
      const response = await fetch(`https://api.github.com/repos/${repo}`);
      if (!response.ok) return null;
      const data = await response.json();
      return data.stargazers_count;
    } catch (error) {
      console.error("Failed to fetch GitHub stars:", error);
      return null;
    }
  }

  function formatStarCount(count: number): string {
    if (count >= 1000) {
      return `${(count / 1000).toFixed(1)}k`;
    }
    return count.toString();
  }

  document.addEventListener("DOMContentLoaded", async () => {
    const starCountEl = document.querySelector(".star-count") as HTMLElement;
    if (!starCountEl) return;

    const repo = starCountEl.dataset.repo;
    if (!repo) return;

    const countEl = starCountEl.querySelector(".count");
    if (!countEl) return;

    const count = await fetchStarCount(repo);

    if (count !== null) {
      countEl.textContent = formatStarCount(count);
    } else {
      countEl.textContent = "—";
    }
  });
</script>
